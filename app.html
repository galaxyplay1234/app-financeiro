<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Minhas Finan√ßas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#1976d2">

<style>
* { box-sizing: border-box; font-family: Arial, sans-serif; }
body { margin: 0; background: #f4f6f8; }

header {
  background: #1976d2;
  color: #fff;
  padding: 15px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

header h2 { margin: 0; font-size: 18px; }
header input { border-radius: 6px; border: none; padding: 6px; }

.cards { display: flex; gap: 10px; padding: 10px; }

.card {
  flex: 1;
  background: #fff;
  padding: 12px;
  border-radius: 10px;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.card h4 { margin: 0; font-size: 14px; color: #666; }
.card .main { font-size: 18px; font-weight: bold; margin-top: 6px; }
.card .sub { font-size: 13px; color: #777; }

.saldo { border-top: 4px solid #1976d2; }
.receita { border-top: 4px solid #2e7d32; }
.despesa { border-top: 4px solid #c62828; }

.list { padding: 10px; }
.list ul { list-style: none; padding: 0; }

.list li {
  background: #fff;
  margin-bottom: 8px;
  padding: 10px;
  border-radius: 8px;
  border-left: 5px solid #2196f3;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.paid { border-left-color: #2e7d32; }
.late { border-left-color: #c62828; }

.actions button {
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  margin-left: 5px;
}

.fab {
  position: fixed;
  right: 20px;
  bottom: 20px;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  font-size: 26px;
  background: #1976d2;
  color: #fff;
  border: none;
}

.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
}

.modal-content {
  background: #fff;
  width: 90%;
  max-width: 320px;
  padding: 20px;
  border-radius: 12px;
}

.modal-content input,
.modal-content select,
.modal-content button {
  width: 100%;
  margin-top: 10px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

.modal-content button {
  background: #1976d2;
  color: #fff;
  border: none;
}

.cancel { background: #aaa !important; }
</style>
</head>

<body>

<script>
if (localStorage.getItem("logged") !== "true") location.href = "index.html";
</script>

<header>
<h2>üí∞ Minhas Finan√ßas</h2>
<input type="month" id="month">
</header>

<section class="cards">
<div class="card saldo">
<h4>Saldo</h4>
<div class="main" id="saldoPago">R$ 0,00</div>
<div class="sub" id="saldoPrevisto">Previsto: R$ 0,00</div>
</div>

<div class="card receita">
<h4>Receitas</h4>
<div class="main" id="receitaPago">R$ 0,00</div>
<div class="sub" id="receitaPrev">Previsto: R$ 0,00</div>
</div>

<div class="card despesa">
<h4>Despesas</h4>
<div class="main" id="despesaPago">R$ 0,00</div>
<div class="sub" id="despesaPrev">Previsto: R$ 0,00</div>
</div>
</section>

<section class="list">
<ul id="list"></ul>
</section>

<button class="fab" onclick="openModal()">+</button>

<div class="modal" id="modal">
<div class="modal-content">
<h3>Novo lan√ßamento</h3>

<input id="name" placeholder="Nome">
<input id="value" type="number" placeholder="Valor">
<input id="category" placeholder="Categoria">
<input id="date" type="date">

<select id="type">
<option value="income">Receita</option>
<option value="expense">Despesa</option>
</select>

<select id="status">
<option value="true">Pago / Recebido</option>
<option value="false">Previsto</option>
</select>

<button onclick="save()">Salvar</button>
<button class="cancel" onclick="closeModal()">Cancelar</button>
</div>
</div>

<script>
const monthInput = document.getElementById("month");
monthInput.value = new Date().toISOString().slice(0,7);
let editIndex = null;

function getData(){ return JSON.parse(localStorage.getItem("finance")) || {}; }
function saveData(d){ localStorage.setItem("finance", JSON.stringify(d)); }

function render(){
const data = getData();
const m = monthInput.value;
const list = data[m] || [];

let rPago=0,rPrev=0,dPago=0,dPrev=0;
const ul = document.getElementById("list");
ul.innerHTML="";

list.forEach((t,i)=>{
if(t.type==="income"){
t.paid ? rPago+=t.value : rPrev+=t.value;
}else{
t.paid ? dPago+=t.value : dPrev+=t.value;
}

const late = !t.paid && new Date(t.date) < new Date();
const li = document.createElement("li");
li.className = t.paid ? "paid" : late ? "late" : "";

li.innerHTML = `
<div>
<strong>${t.name}</strong><br>
<small>${t.category} ‚Ä¢ ${t.date}</small>
</div>
<div>
R$ ${t.value.toFixed(2)}
<span class="actions">
<button onclick="edit(${i})">‚úèÔ∏è</button>
<button onclick="remove(${i})">üóëÔ∏è</button>
</span>
</div>`;
ul.appendChild(li);
});

document.getElementById("receitaPago").innerText=`R$ ${rPago.toFixed(2)}`;
document.getElementById("receitaPrev").innerText=`Previsto: R$ ${(rPago+rPrev).toFixed(2)}`;
document.getElementById("despesaPago").innerText=`R$ ${dPago.toFixed(2)}`;
document.getElementById("despesaPrev").innerText=`Previsto: R$ ${(dPago+dPrev).toFixed(2)}`;

document.getElementById("saldoPago").innerText=`R$ ${(rPago-dPago).toFixed(2)}`;
document.getElementById("saldoPrevisto").innerText=`Previsto: R$ ${((rPago+rPrev)-(dPago+dPrev)).toFixed(2)}`;
}

function save(){
const data = getData();
const m = monthInput.value;
if(!data[m]) data[m]=[];

const item = {
name:name.value,
value:Number(value.value),
category:category.value,
date:date.value,
type:type.value,
paid:status.value==="true"
};

if(editIndex!==null){
data[m][editIndex]=item;
editIndex=null;
}else{
data[m].push(item);
}

saveData(data);
closeModal();
render();
}

function edit(i){
const t = getData()[monthInput.value][i];
name.value=t.name;
value.value=t.value;
category.value=t.category;
date.value=t.date;
type.value=t.type;
status.value=String(t.paid);
editIndex=i;
openModal();
}

function remove(i){
const data=getData();
data[monthInput.value].splice(i,1);
saveData(data);
render();
}

function openModal(){ document.getElementById("modal").style.display="flex"; }
function closeModal(){ document.getElementById("modal").style.display="none"; }

monthInput.addEventListener("change", render);
render();
</script>

</body>
</html>