<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Minhas FinanÃ§as</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#1976d2">

<style>
*{box-sizing:border-box;font-family:Arial,sans-serif}
body{margin:0;background:#f4f6f8}

header{
background:#1976d2;
color:#fff;
padding:15px;
display:flex;
justify-content:space-between;
align-items:center
}

.cards{display:flex;gap:10px;padding:10px}

.card{
flex:1;
background:#fff;
padding:12px;
border-radius:10px;
text-align:center;
box-shadow:0 2px 6px rgba(0,0,0,.1)
}

.card h4{margin:0;font-size:14px;color:#666}
.card .main{font-size:18px;font-weight:bold;margin-top:6px}
.card .sub{font-size:13px;color:#777}

.saldo{border-top:4px solid #1976d2}
.receita{border-top:4px solid #2e7d32}
.despesa{border-top:4px solid #c62828}

.list{padding:10px}

.row{
display:flex;
gap:8px;
margin-bottom:8px;
cursor:pointer
}

.date-card{
width:56px;
background:#fff;
border-radius:10px;
display:flex;
align-items:center;
justify-content:center;
font-size:14px;
font-weight:bold;
color:#888;
box-shadow:0 1px 4px rgba(0,0,0,.1);
height:64px
}

.item{
flex:1;
background:#fff;
padding:10px;
border-radius:10px;
border-left:5px solid #2196f3;
box-shadow:0 1px 4px rgba(0,0,0,.1);
height:64px;
display:flex;
flex-direction:column;
justify-content:center
}

.item-top{
display:flex;
justify-content:space-between;
align-items:flex-start
}

.item-name{font-weight:bold;font-size:14px}

.item-value{
font-size:16px;
font-weight:bold;
text-align:right
}

.income{color:#2e7d32}
.expense{color:#c62828}

.item-bottom{
display:flex;
justify-content:space-between;
align-items:center;
margin-top:2px
}

.item-sub{
font-size:12px;
color:#666
}

.badge{
padding:2px 8px;
font-size:12px;
border-radius:12px;
color:#fff;
white-space:nowrap
}

.green{background:#2e7d32}
.red{background:#c62828}

.fab{
position:fixed;
right:20px;
bottom:20px;
width:56px;
height:56px;
border-radius:50%;
font-size:26px;
background:#1976d2;
color:#fff;
border:none
}

.modal{
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,.5);
justify-content:center;
align-items:center
}

.modal-content{
background:#fff;
width:90%;
max-width:320px;
padding:20px;
border-radius:12px
}

.modal-content input,
.modal-content select,
.modal-content button{
width:100%;
margin-top:10px;
padding:10px;
border-radius:8px;
border:1px solid #ccc
}

.modal-content button{
background:#1976d2;
color:#fff;
border:none
}

.delete{background:#c62828!important}
.cancel{background:#aaa!important}
</style>
</head>

<body>

<header>
<h2>ðŸ’° Minhas FinanÃ§as</h2>
<input type="month" id="month">
</header>

<section class="cards">
<div class="card saldo">
<h4>Saldo</h4>
<div class="main" id="saldoPago">R$ 0,00</div>
<div class="sub" id="saldoPrev">R$ 0,00</div>
</div>

<div class="card receita">
<h4>Receitas</h4>
<div class="main" id="recPago">R$ 0,00</div>
<div class="sub" id="recPrev">R$ 0,00</div>
</div>

<div class="card despesa">
<h4>Despesas</h4>
<div class="main" id="despPago">R$ 0,00</div>
<div class="sub" id="despPrev">R$ 0,00</div>
</div>
</section>

<section class="list" id="list"></section>

<button class="fab" onclick="openModal()">+</button>

<div class="modal" id="modal">
<div class="modal-content">
<input id="name" placeholder="Nome">
<input id="value" type="number" placeholder="Valor">
<input id="category" placeholder="Categoria">
<input id="date" type="date">

<select id="type">
<option value="income">Receita</option>
<option value="expense">Despesa</option>
</select>

<select id="paid">
<option value="false">Previsto</option>
<option value="true">Pago / Recebido</option>
</select>

<button onclick="save()">Salvar</button>
<button id="deleteBtn" class="delete" onclick="remove()">Excluir</button>
<button class="cancel" onclick="closeModal()">Cancelar</button>
</div>
</div>

<script>
const monthInput=document.getElementById("month");
const modal=document.getElementById("modal");
const deleteBtn=document.getElementById("deleteBtn");

monthInput.value=new Date().toISOString().slice(0,7);
let editIndex=null;

function getData(){return JSON.parse(localStorage.getItem("finance"))||{}}
function saveData(d){localStorage.setItem("finance",JSON.stringify(d))}

function formatDate(d){
const [y,m,day]=d.split("-");
return `${day}/${m}`;
}

function render(){
const data=getData();
const m=monthInput.value;
let list=data[m]||[];

list.sort((a,b)=>new Date(b.date)-new Date(a.date));

let rPago=0,rPrev=0,dPago=0,dPrev=0;
const container=document.getElementById("list");
container.innerHTML="";

list.forEach((t,i)=>{
if(t.type==="income"){
t.paid?rPago+=t.value:rPrev+=t.value;
}else{
t.paid?dPago+=t.value:dPrev+=t.value;
}

const late=!t.paid&&new Date(t.date)<new Date();

const row=document.createElement("div");
row.className="row";
row.onclick=()=>edit(i);

row.innerHTML=`
<div class="date-card">${formatDate(t.date)}</div>
<div class="item">
<div class="item-top">
<div class="item-name">${t.name}</div>
<div class="item-value ${t.type}">R$ ${t.value.toFixed(2)}</div>
</div>
<div class="item-bottom">
<div class="item-sub">${t.category}</div>
${t.paid
?`<div class="badge green">${t.type==="income"?"Recebido":"Pago"}</div>`
:late
?`<div class="badge red">Atrasado</div>`
:""}
</div>
</div>`;
container.appendChild(row);
});

recPago.innerText=`R$ ${rPago.toFixed(2)}`;
recPrev.innerText=`R$ ${(rPago+rPrev).toFixed(2)}`;
despPago.innerText=`R$ ${dPago.toFixed(2)}`;
despPrev.innerText=`R$ ${(dPago+dPrev).toFixed(2)}`;
saldoPago.innerText=`R$ ${(rPago-dPago).toFixed(2)}`;
saldoPrev.innerText=`R$ ${((rPago+rPrev)-(dPago+dPrev)).toFixed(2)}`;
}

function save(){
if(!name.value.trim())return alert("Informe o nome");

const data=getData();
const m=monthInput.value;
if(!data[m])data[m]=[];

const item={
name:name.value.trim(),
value:Number(value.value),
category:category.value,
date:date.value,
type:type.value,
paid:paid.value==="true"
};

editIndex!==null?data[m][editIndex]=item:data[m].push(item);
saveData(data);
closeModal();
render();
}

function edit(i){
const data=getData();
const t=data[monthInput.value][i];

name.value=t.name;
value.value=t.value;
category.value=t.category;
date.value=t.date;
type.value=t.type;
paid.value=String(t.paid);

editIndex=i;
deleteBtn.style.display="block";
openModal();
}

function remove(){
const data=getData();
const m=monthInput.value;
if(editIndex!==null){
data[m].splice(editIndex,1);
saveData(data);
}
closeModal();
render();
}

function openModal(){
modal.style.display="flex";
if(editIndex===null){
name.value="";
value.value="";
category.value="";
date.value="";
type.value="income";
paid.value="false";
deleteBtn.style.display="none";
}
}

function closeModal(){
modal.style.display="none";
editIndex=null;
}

monthInput.addEventListener("change",render);
render();
</script>

</body>
</html>